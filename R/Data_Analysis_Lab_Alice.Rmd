---
title: "Report: Testing hybrid vigor in the lab in response to Eimeria"
author: "Alice"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  pdf_document:
    toc: yes
    toc_depth: '4'
    fig_caption: yes        
    includes:  
      in_header: preamble-latex.tex
  word_document:
    toc: yes
    toc_depth: 4
    fig_caption: yes        
    includes:  
      in_header: preamble-latex.tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# source("../R/dataPreparation.R")
source("../R/functions.R")
library(ggplot2)
library(gridExtra)
library(reshape2)
library(scales)
mytheme <- theme_bw()+
  theme(plot.title = element_text(size=22), plot.subtitle = element_text(size = 20),
        legend.text = element_text(size = 20),
        axis.text=element_text(size=20),
        axis.title=element_text(size=20,face="bold"),
        legend.key = element_rect(size = 5),
        legend.key.size = unit(1.5, 'lines'),
        strip.text = element_text(size=25))

calculateWeightLoss <- function(x, startingDay = 0){
  # define weight at infection
  A = x[x$dpi == startingDay, c("weight", "EH_ID")]
  names(A)[1] = "startingWeight"
  x = merge(x, A)
  # Cumulative sum of our weight loss
  x = x %>% 
    group_by(EH_ID) %>% 
    dplyr::arrange(dpi, .by_group = TRUE) %>%
    dplyr::mutate(relativeWeight = weight / startingWeight * 100)
  x = data.frame(x)
  return(x)
}
```

# Expe_001, March 2017, Francisca's experiment. infection with E64 and Eflab

```{r setupExpe1, echo=FALSE, warning=FALSE}
# ExpeDF need at least the following:
# "OPG", "EH_ID", "dpi", "weight", "EH_ID", "infection_isolate", "Mouse_strain"
ExpeDF_001 <- read.csv("../data/3_recordingTables/Exp001_May2017_crossing_infection.csv")

# Add mice subspecies info
ExpeDF_001$Mouse_subspecies <- "F1 hybrids"
ExpeDF_001$Mouse_subspecies[ExpeDF_001$Mouse_strain == "PWD"] <- "M.m.musculus"
ExpeDF_001$Mouse_subspecies[ExpeDF_001$Mouse_strain == "WSB"] <- "M.m.domesticus"
ExpeDF_001$Mouse_subspecies <- factor(ExpeDF_001$Mouse_subspecies,
                                      levels = c("M.m.domesticus", "F1 hybrids", "M.m.musculus"))

# Mouse_strain: West should always be left
ExpeDF_001$Mouse_strain <- factor(ExpeDF_001$Mouse_strain,
                                  levels = c("WSB", "WP", "PWD"),
                                  labels = c("M.m.domesticus \n(WSB)",
                                             "F1 hybrids \n(WP)",
                                             "M.m.musculus \n(PWD)"))

# Enter Eimeria species
ExpeDF_001$Eimeria_species[ExpeDF_001$infection_isolate %in% c("E88", "Eflab", "EfLab")] = "E.falciformis"
ExpeDF_001$Eimeria_species[ExpeDF_001$infection_isolate %in% c("E64", "EI64", "E139")] = "E.ferrisi"

# Keep only mice that survived 11 days
survivors <- names(table(ExpeDF_001$EH_ID))[table(ExpeDF_001$EH_ID) %in% 12]
ExpeDF_001 <- ExpeDF_001[ExpeDF_001$EH_ID %in% survivors,]

# calculate relative weight loss compared to dpi0
ExpeDF_001 <- calculateWeightLoss(ExpeDF_001, startingDay = 3)

# calculate summary statistics on weight loss
summaryWeight_001 <- summarySE(ExpeDF_001, measurevar = "relativeWeight",
                           groupvars=c("Mouse_strain", "Mouse_subspecies", "Eimeria_species",
                                       "infection_isolate", "dpi"))
summaryWeight_001$ci[is.na(summaryWeight_001$ci)] <- 0

# calculate summary statistics on oocysts shedding
summaryOocysts_001 <-summarySE(ExpeDF_001, measurevar="OPG", 
                           groupvars=c("Mouse_strain", "Mouse_subspecies", "Eimeria_species",
                                       "infection_isolate", "dpi"))
summaryOocysts_001$ci[is.na(summaryOocysts_001$ci)] <- 0

# Add OPG status
ExpeDF_001$OPGstatus[is.na(ExpeDF_001$OPG)] = "na"
ExpeDF_001$OPGstatus[!is.na(ExpeDF_001$OPG) & ExpeDF_001$OPG > 0] = "positive"
ExpeDF_001$OPGstatus[!is.na(ExpeDF_001$OPG) & ExpeDF_001$OPG == 0] = "negative"
ExpeDF_001$OPGstatus = as.factor(ExpeDF_001$OPGstatus)
```

## 1. Weight loss
```{r weightalong1, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
ggplot(ExpeDF_001, aes(x = dpi, y = weight, fill = OPGstatus)) +
  geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5) +
  geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5) +
  scale_color_manual(values = c("blue", "purple", "red")) +
  geom_point(size=4, pch = 21, color = "black")+
  scale_fill_manual(values = c("lightgrey", "yellow")) +
  mytheme +
  facet_grid(Mouse_strain ~ infection_isolate, scales = "free_y", space = "free") +
  scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
  scale_y_continuous(name = "Weight relative to dpi3 (%)") +
  theme(strip.text.y = element_text(size = 15)) +
  theme(legend.position="none") +
  ggtitle("Weight along experiment compared to dpi3", subtitle = "yellow : oocysts detected in feces")

ggplot(ExpeDF_001, aes(x = dpi, y = relativeWeight, fill = OPGstatus)) +
  geom_rect(aes(xmin = 3, xmax = 8, ymin = 80, ymax = 110), fill = "lightgrey", alpha = .5) +
  geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5) +
  scale_color_manual(values = c("blue", "purple", "red")) +
  geom_point(size=4, pch = 21, color = "black")+
  scale_fill_manual(values = c("lightgrey", "yellow")) +
  mytheme +
  facet_grid(Mouse_strain ~ infection_isolate, scales = "free_y", space = "free") +
  scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
  scale_y_continuous(name = "Weight relative to dpi3 (%)") +
  coord_cartesian(ylim = c(80, 110)) +
  theme(strip.text.y = element_text(size = 15)) +
  theme(legend.position="none") +
  ggtitle("Relative weight along experiment compared to dpi3", subtitle = "yellow : oocysts detected in feces")
```

```{r weightalongsum, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
ggplot(summaryWeight_001, aes(x = dpi, y = relativeWeight))+
  geom_rect(aes(xmin = 3, xmax = 8, ymin = 85, ymax = 115), fill = "lightgrey", alpha = .5) +
  geom_errorbar(aes(ymin = relativeWeight - ci, ymax = relativeWeight + ci)) +
  geom_line(aes(group = Mouse_strain, col = Mouse_strain), size = 2, alpha = 0.5) +
  geom_point(aes(fill = Mouse_strain), size=4, pch = 21, color = "black") +
  scale_color_manual(values = c("blue", "purple", "red")) +
  scale_fill_manual(values = c("blue", "purple", "red")) +
  mytheme +
  facet_grid(Mouse_strain ~ infection_isolate, scales = "free_y", space = "free") +
  scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
  scale_y_continuous(name = "Weight relative to dpi3 (%)") +
  coord_cartesian(ylim = c(85, 115)) +
  theme(legend.position="none") +
  ggtitle("Mean relative weight along experiment compared to dpi3")
```

For statistical analysis, we compare the maximum relative weight loss between the different groups. We limit our analysis to the period : dpi3 to dpi8 (symptomatic period for E64 strain).

```{r stats1, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
ExpeDF_001Symptomatic <- ExpeDF_001[ExpeDF_001$dpi %in% 3:8,]
max.loss_001 <- do.call("rbind", by(ExpeDF_001Symptomatic, ExpeDF_001Symptomatic$EH_ID, function (x){
  m.loss <- which(x$relativeWeight == min(x$relativeWeight, na.rm=TRUE))
  x[m.loss,]
}))

# tapply(max.loss$relativeWeight, max.loss$infection_isolate:max.loss$Mouse_strain, mean)
 
ggplot(max.loss_001, aes(Mouse_strain,100-relativeWeight, color=infection_isolate)) +
  geom_boxplot(color = "black")+
  ggtitle("Maximum weigth loss during the symptomatic phase") +
  facet_wrap(~infection_isolate) +
  geom_jitter(width=0.1, size=7, pch = 21,
              color = "black", aes(fill = Mouse_strain), alpha = 0.8) +
  labs(y= "Maximum weigth loss relative to weight at dpi 3", x= "Mouse strain")+
  scale_fill_manual(values = c("blue", "purple", "red")) +
  mytheme +
  theme(legend.position="none")

summary(lm(relativeWeight~Mouse_strain, data = max.loss_001))
```

## 2. Parasite shedding

```{r OPGalong1, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
ggplot(ExpeDF_001, aes(x = dpi, y = OPG, fill = infection_isolate))+
  geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5) +
  geom_line(aes(group = EH_ID, col = Mouse_strain), alpha = 0.5, size = 2) +
  geom_point(size=3, aes(color = Mouse_strain))+
  scale_color_manual(values = c("blue", "purple", "red")) +
  facet_grid(Mouse_strain ~ infection_isolate) +
  mytheme +
  scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
  ylab("Oocysts shedding along infection (OPG)") +
  ggtitle("Oocyst shedding along experiment") +
  theme(legend.position="none") 
```

```{r OPGalongsum1, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
ggplot(summaryOocysts_001, aes(x = dpi, y = OPG))+
  geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5) +
  geom_errorbar(aes(ymin = OPG - ci, ymax = OPG + ci)) +
  geom_line(aes(group = Mouse_strain, col = Mouse_strain), size = 2, alpha = 0.5) +
  geom_point(aes(fill = Mouse_strain), size=4, pch = 21, color = "black") +
  scale_color_manual(values = c("blue", "purple", "red")) +
  scale_fill_manual(values = c("blue", "purple", "red")) +
  mytheme +
  facet_grid(Mouse_strain ~ infection_isolate) +
  scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
  scale_y_continuous(name = "Oocysts shedding along infection (OPG)") +
  theme(legend.position="none") +
  ggtitle("Mean oocysts shedding along experiment")
```


```{r stats1opg, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
# Cumulative OPG along experiment
all.sum.oocysts_001 <- do.call("rbind", by(ExpeDF_001, ExpeDF_001$EH_ID, function (x){
  x$sum.oo <- sum(x$OPG, na.rm = TRUE)
  x
}))
sum.oocysts_001 <- all.sum.oocysts_001[!duplicated(all.sum.oocysts_001$EH_ID),]

ggplot(sum.oocysts_001, aes(Mouse_strain, sum.oo, color=infection_isolate)) +
  geom_boxplot(color = "black")+
  ggtitle("Sum of oocysts shed along the experiment") +
  facet_wrap(~infection_isolate) +
  geom_jitter(width=0.1, size=7, pch = 21,
              color = "black", aes(fill = Mouse_strain), alpha = 0.8) +
  labs(y= "Sum of oocysts shed along experiment, OPG (oocysts per gram)", x= "Mouse strain")+
  scale_fill_manual(values = c("blue", "purple", "red")) +
  mytheme +
  theme(legend.position="none")

summary(lm(sum.oo~Mouse_strain, data = sum.oocysts_001))
```

<!-- ## 3. Comparison host/parasite proxy -->

<!-- ```{r plotComp1, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:plotComp1} Weight as a function of OPG"} -->
<!-- plotCompOPGWeight(ExpeDF_001) -->
<!-- ``` -->

<!-- # Expe_002: March 2018, NMRI mice infected with 4 *Eimeria* strains (Eflab, E88, E139, E64) -->

<!-- ## 1. Weight loss -->
<!-- ```{r weightalong2, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:weightalong2} Weight along the infection experiment"} -->
<!-- plotWeightAlongInf(ExpeDF_002, ylim = c(88, 108)) -->
<!-- ``` -->

<!-- ```{r weightalongsum2, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:weightalongsum2} Weight along the infection experiment, mean and 95% CI"} -->
<!-- plotWeightAlongInfSUM(ExpeDF_002, ylim = c(88, 108)) -->
<!-- ``` -->

<!-- ## 2. Parasite shedding -->

<!-- ```{r OPGalong2, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:OPGalong2} Oocysts shedding along the infection experiment"} -->
<!-- plotOPGAlongInf(ExpeDF_002) -->
<!-- ``` -->

<!-- ```{r OPGalongsum2, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:OPGalongsum2} Oocysts shedding along the infection experiment, mean and 95% CI"} -->
<!-- plotOPGAlongInfSUM(ExpeDF_002) -->
<!-- ``` -->

<!-- ## 3. Comparison host/parasite proxy -->

<!-- ```{r plotComp2, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:plotComp2} Weight as a function of OPG"} -->
<!-- plotCompOPGWeight(ExpeDF_002) -->
<!-- ``` -->

<!-- # Expe_003, April-May 2018, first batch Parental strains (F0) BUSNA, STRA, SCHUNT, PWD, infection with Eferrisi (E64 and E139) -->

<!-- ## 1. Weight loss -->

<!-- ```{r weightalong3, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:weightalong3} Weight along the infection experiment"} -->
<!-- plotWeightAlongInf(ExpeDF_003, ylim = c(85, 120)) -->
<!-- ``` -->

<!-- ```{r weightalongsum3, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:weightalongsum3} Weight along the infection experiment, mean and 95% CI"} -->
<!-- plotWeightAlongInfSUM(ExpeDF_003, ylim = c(85, 120)) -->
<!-- ``` -->

<!-- ## 2. Parasite shedding -->

<!-- ```{r OPGalong3, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:OPGalong3} Oocysts shedding along the infection experiment"} -->
<!-- plotOPGAlongInf(ExpeDF_003) -->
<!-- ``` -->

<!-- ```{r OPGalongsum3, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:OPGalongsum3} Oocysts shedding along the infection experiment, mean and 95% CI"} -->
<!-- plotOPGAlongInfSUM(ExpeDF_003) -->
<!-- ``` -->

<!-- ## 3. Comparison host/parasite proxy -->

<!-- ```{r plotComp3, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:plotComp3} Weight as a function of OPG"} -->
<!-- plotCompOPGWeight(ExpeDF_003, ylim = c(90, 115)) -->
<!-- ``` -->

<!-- # Expe_004, June 2018, second batch Parental strains (F0) BUSNA, STRA, SCHUNT, PWD, infection with Eferrisi (E64 and E139) -->

<!-- ## 1. Weight loss -->

<!-- ```{r weightalong4, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:weightalong4} Weight along the infection experiment"} -->
<!-- plotWeightAlongInf(ExpeDF_004, ylim = c(90, 115)) -->
<!-- ``` -->

<!-- ```{r weightalongsum4, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10, fig.cap="\\label{fig:weightalongsum4} Weight along the infection experiment, mean and 95% CI"} -->
<!-- plotWeightAlongInfSUM(ExpeDF_004, ylim = c(85, 120)) -->
<!-- ``` -->

<!-- ## 2. Parasite shedding -->


# Expe_005, July 2018, FULL experiment (parents, intra specific and inter species hybrids) BUSNA, STRA, SCHUNT, PWD, infection with Eferrisi (E64 and E139)

```{r setupExpe5, echo=FALSE, warning=FALSE}
########################### Exp005 : Full expe including hybrids, July 2018 
oo <- read.csv("../data/3_recordingTables/Exp005_full_RECORDoocysts.csv", na.strings = c("NA", " "))
we <- read.csv("../data/3_recordingTables/Exp005_full_RECORDweight.csv", na.strings = c("NA", " "))
design <- rbind(read.csv("../data/2_designTables/Inf1a_Exp005.DESIGN.csv", na.strings = c("NA", " ")),
                read.csv("../data/2_designTables/Inf2a_Exp005.DESIGN.csv", na.strings = c("NA", " ")),
                read.csv("../data/2_designTables/Inf1b_Exp005.DESIGN.csv", na.strings = c("NA", " ")),
                read.csv("../data/2_designTables/Inf2b_Exp005.DESIGN.csv", na.strings = c("NA", " ")))
# Correct error
names(design)[names(design) == "EH_id"] <- "EH_ID"
# Correct space error
design$EH_ID <- gsub(" ", "", design$EH_ID)
design$HybridStatus <- gsub(" ", "", design$HybridStatus)
ExpeDF_005 <- merge(oo, we, by = c("labels", "Expe"))
ExpeDF_005 <- merge(ExpeDF_005, design, by = "EH_ID", all.x = T)
## Correct error space
ExpeDF_005$Strain <- gsub(" ", "", ExpeDF_005$Strain)
# Correct error non numeric
ExpeDF_005$weight <- as.numeric(as.character(ExpeDF_005$weight))
ExpeDF_005$weight_dpi0 <- as.numeric(as.character(ExpeDF_005$weight_dpi0))
# Correct weight loss
ExpeDF_005$weightloss <- ExpeDF_005$weight_dpi0 - ExpeDF_005$weight

# Calculate weight Normalized to dpi0
ExpeDF_005 <- calculateWeightLoss(ExpeDF_005, startingDay = 3)

# Add mice subspecies info
ExpeDF_005$Mouse_subspecies <- factor(as.factor(ExpeDF_005$Strain),
                                  levels = c("BUSNA_BUSNA","BUSNA_PWD","BUSNA_STRA","PWD_BUSNA",
                                             "PWD_PWD","PWD_SCHUNT","SCHUNT_PWD","SCHUNT_SCHUNT",
                                             "SCHUNT_STRA","STRA_BUSNA","STRA_SCHUNT","STRA_STRA"),
                                  labels = c("M.m.musculus P", "M.m.musculus F1",
                                             "Hybrid", "M.m.musculus F1",
                                             "M.m.musculus P","Hybrid",
                                             "Hybrid", "M.m.domesticus P",
                                             "M.m.domesticus F1","Hybrid",
                                             "M.m.domesticus F1","M.m.domesticus P"))
# # Mouse_strain: West should always be left
ExpeDF_005$Mouse_strain <- factor(as.factor(ExpeDF_005$Strain),
                                  levels = c("BUSNA_BUSNA","BUSNA_PWD",
                                             "BUSNA_STRA","PWD_BUSNA",
                                             "PWD_PWD","PWD_SCHUNT",
                                             "SCHUNT_PWD","SCHUNT_SCHUNT",
                                             "SCHUNT_STRA","STRA_BUSNA",
                                             "STRA_SCHUNT","STRA_STRA"),
                                  labels = c("M.m.musculus P \n(BUSNA_BUSNA)", "M.m.musculus F1 \n(BUSNA_PWD)",
                                             "Hybrid \n(BUSNA_STRA)", "M.m.musculus F1 \n(PWD_BUSNA)",
                                             "M.m.musculus P \n(PWD_PWD)","Hybrid \n(PWD_SCHUNT)",
                                             "Hybrid \n(SCHUNT_PWD)", "M.m.domesticus P \n(SCHUNT_SCHUNT)",
                                             "M.m.domesticus F1 \n(SCHUNT_STRA)","Hybrid \n(STRA_BUSNA)",
                                             "M.m.domesticus F1 \n(STRA_SCHUNT)","M.m.domesticus P \n(STRA_STRA)"))

# Add infection isolate
ExpeDF_005$infection_isolate <- ExpeDF_005$Eimeria

# Enter Eimeria species
ExpeDF_005$Eimeria_species[ExpeDF_005$infection_isolate %in% c("E88", "Eflab", "EfLab")] <- "E.falciformis"
ExpeDF_005$Eimeria_species[ExpeDF_005$infection_isolate %in% c("E64", "EI64", "E139")] = "E.ferrisi"

# # Age at infection
# ExpeDF_005$ageAtInfection[ExpeDF_005$Batch == 1] <- round(ExpeDF_005$ageAtdpi0expe1a)
# ExpeDF_005$ageAtInfection[ExpeDF_005$Batch == 2] <- round(ExpeDF_005$ageAtdpi0expe1a +2)
# 
# # Keep only mice that survived 11 days for E. falciformis, and N days for E. ferrisi
# survivors <- names(table(ExpeDF_001$EH_ID))[table(ExpeDF_001$EH_ID) %in% 12]
# ExpeDF_001 <- ExpeDF_001[ExpeDF_001$EH_ID %in% survivors,]

# Add OPG status
ExpeDF_005$OPGstatus[is.na(ExpeDF_005$OPG)] = "na"
ExpeDF_005$OPGstatus[!is.na(ExpeDF_005$OPG) & ExpeDF_005$OPG > 0] = "positive"
ExpeDF_005$OPGstatus[!is.na(ExpeDF_005$OPG) & ExpeDF_005$OPG == 0] = "negative"
ExpeDF_005$OPGstatus = as.factor(ExpeDF_005$OPGstatus)

# Split in 2 infection batches (Efalciformis and Eferrisi are studied separetely)
ExpeDF_005_E88 <- ExpeDF_005[ExpeDF_005$infection_isolate %in% "E88",]
ExpeDF_005_E64 <- ExpeDF_005[ExpeDF_005$infection_isolate %in% "E64",]

# calculate relative weight loss compared to dpi0 for E64
ExpeDF_005_E64 <- calculateWeightLoss(ExpeDF_005_E64, startingDay = 3)

# # calculate summary statistics on weight loss
# summaryWeight_001 <- summarySE(ExpeDF_001, measurevar = "relativeWeight",
#                            groupvars=c("Mouse_strain", "Mouse_subspecies", "Eimeria_species",
#                                        "infection_isolate", "dpi"))
# summaryWeight_001$ci[is.na(summaryWeight_001$ci)] <- 0
# 
# # calculate summary statistics on oocysts shedding
# summaryOocysts_001 <-summarySE(ExpeDF_001, measurevar="OPG", 
#                            groupvars=c("Mouse_strain", "Mouse_subspecies", "Eimeria_species",
#                                        "infection_isolate", "dpi"))
# summaryOocysts_001$ci[is.na(summaryOocysts_001$ci)] <- 0


```

## 1. Weight loss
```{r weightalong5_E64, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
ggplot(ExpeDF_005_E64, aes(x = dpi, y = weight, fill = OPGstatus)) +
  geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5) +
  geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5) +
  # scale_color_manual(values = c("blue", "purple", "red")) +
  geom_point(size=4, pch = 21, color = "black")+
  scale_fill_manual(values = c("lightgrey", "yellow")) +
  mytheme +
  facet_grid(Mouse_subspecies ~ .) +
  scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
  scale_y_continuous(name = "Weight relative to dpi3 (%)") +
  theme(strip.text.y = element_text(size = 15)) +
  theme(legend.position="none") +
  ggtitle("Weight along experiment compared to dpi3 (E64)", subtitle = "yellow : oocysts detected in feces")

ggplot(ExpeDF_005_E64, aes(x = dpi, y = relativeWeight, fill = OPGstatus)) +
  geom_rect(aes(xmin = 3, xmax = 8, ymin = 80, ymax = 110), fill = "lightgrey", alpha = .5) +
  geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5) +
  # scale_color_manual(values = c("blue", "purple", "red")) +
  geom_point(size=4, pch = 21, color = "black")+
  scale_fill_manual(values = c("lightgrey", "yellow")) +
  mytheme +
  facet_grid(Mouse_subspecies ~ .) +
  scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
  scale_y_continuous(name = "Weight relative to dpi3 (%)") +
  coord_cartesian(ylim = c(80, 110)) +
  theme(strip.text.y = element_text(size = 15)) +
  theme(legend.position="none") +
  ggtitle("Relative weight along experiment compared to dpi3 (E64)", subtitle = "yellow : oocysts detected in feces")
```
