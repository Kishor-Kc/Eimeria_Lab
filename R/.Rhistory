p.adjust.method = "BH")
# Cumulative OPG along experiment
all.sum.oocysts_001_88 <- do.call("rbind", by(ExpeDF_001[ExpeDF_001$Eimeria_species %in% "E.ferrisi",], ExpeDF_001[ExpeDF_001$Eimeria_species %in% "E.ferrisi", "EH_ID"], function (x){
x$sum.oo <- sum(x$OPG, na.rm = TRUE)
x
}))
sum.oocysts_001_88 <- all.sum.oocysts_001_88[!duplicated(all.sum.oocysts_001_88$EH_ID),]
ggplot(sum.oocysts_001_88, aes(Mouse_strain, sum.oo, color=infection_isolate)) +
geom_boxplot(color = "black")+
ggtitle("Sum of oocysts shed along the experiment (E88)") +
geom_jitter(width=0.1, size=7, pch = 21,
color = "black", aes(fill = Mouse_strain), alpha = 0.8) +
labs(y= "Sum of oocysts shed along experiment, OPG (oocysts per gram)", x= "Mouse strain")+
scale_fill_manual(values = c("blue", "purple", "red")) +
mytheme +
theme(legend.position="none")
sum.oocysts_001_88$Mouse_strain <- factor(sum.oocysts_001_88$Mouse_strain,
levels = c("F1 hybrids \n(WP)",
"M.m.domesticus \n(WSB)",
"M.m.musculus \n(PWD)"))
kruskal.test(sum.oo ~ Mouse_strain, data = sum.oocysts_001_88)
pairwise.wilcox.test(sum.oocysts_001_88$sum.oo, sum.oocysts_001_88$Mouse_strain,
p.adjust.method = "BH")
## Plot comparison weightloss vs OPG, all day counfounded
ggplot(ExpeDF_001Symptomatic_64,
aes(x = OPG+1, y = relativeWeight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (E64)") +
mytheme
## Plot comparison weightloss vs OPG, all day counfounded
ggplot(ExpeDF_001Symptomatic_64,
aes(x = OPG+1, y = relativeWeight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (E64)") +
scale_fill_manual(values = c("blue", "purple", "red"))
## Plot comparison weightloss vs OPG, all day counfounded
ggplot(ExpeDF_001Symptomatic_64,
aes(x = OPG+1, y = relativeWeight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (E64)") +
scale_fill_manual(values = c("blue", "purple", "red")) +
mytheme
ggplot(ExpeDF_001Symptomatic_64,
aes(x = OPG+1, y = relativeWeight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (E64)") +
scale_fill_manual(values = c("blue", "purple", "red")) +
mytheme
read.csv("../data/3_recordingTables/Exp008_Jan2019_NMRI_4isolatespassaging.csv")
Expe008_record <- read.csv("../data/3_recordingTables/Exp008_Jan2019_NMRI_4isolatespassaging.csv")
Expe008_design <- read.csv("../data/2_designTables/Exp008_NMRI_DESIGN_jan2019.csv")
Expe008_record <- read.csv("../data/3_recordingTables/Exp008_Jan2019_NMRI_4isolatespassaging.csv")
Expe008_design <- read.csv("../data/2_designTables/Exp008_NMRI_DESIGN_jan2019.csv")
View(Expe008_design)
View(Expe008_record)
merge(Expe008_design, Expe008_record)
Expe008 <- merge(Expe008_design, Expe008_record)
View(Expe008)
source("functions.R")
source("functions4InfectionExperiments.R")
calculateOPG
calculateWeightLoss
calculateWeightLoss(Expe008, startingDay = 0)
Expe008 <- calculateWeightLoss(Expe008, startingDay = 0)
View(Expe008)
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = weight)) +
geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5) +
geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5) +
scale_color_manual(values = c("blue", "purple", "red")) +
geom_point(size=4, pch = 21, color = "black")+
scale_fill_manual(values = c("lightgrey", "black", "yellow")) +
mytheme +
facet_grid(Mouse_strain ~ infection_isolate, scales = "free_y", space = "free") +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
theme(legend.position="none") +
ggtitle("Weight along experiment per individual", subtitle = "yellow : oocysts detected in feces")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = weight)) +
geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5)# +
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = weight)) +
geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5)# +
View(Expe008)
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = weight)) +
geom_line(aes(group = EH_ID), size = 2, alpha = 0.5)# +
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeweight)) +
geom_line(aes(group = EH_ID), size = 2, alpha = 0.5)# +
View(Expe008)
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID), size = 2, alpha = 0.5)# +
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID), size = 2, alpha = 0.5) +
geom_point(size=4, pch = 21, color = "black")#+
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID)) +
geom_point(size=4, pch = 21, color = "black")#+
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, fill = isolate)) +
geom_point(size=4, pch = 21, color = "black")#+
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, fill = Isolate)) +
geom_point(size=4, pch = 21, color = "black")#+
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, fill = Isolate)) #+
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, fill = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))#+
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))#+
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
theme(legend.position="none") +
ggtitle("Weight along experiment per individual", subtitle = "yellow : oocysts detected in feces")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
theme(legend.position="none") +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
library(directlabels)
install.packages("directlabels")
library(directlabels)
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual") +
geom_dl(aes(label = Isolate), method = list(dl.combine("first.points", "last.points"), cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual") +
geom_dl(aes(label = Isolate), method = list("last.points"), cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual") +
geom_dl(aes(label = Isolate), method = list(dl.combine("last.points"), cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual") +
geom_dl(aes(label = Isolate), method = list(dl.trans(x = x + 0.2), cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual") +
geom_dl(aes(label = Isolate), method = list(dl.trans(x = x + 2), cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
# geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual") +
geom_dl(aes(label = Isolate), method = list(dl.trans(x = x + 2), cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate), method = list(dl.trans(x = x + 2), cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate), method = list(dl.trans(x = x + 2), cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual") +
ggplot(temp.dat, aes(x = Year, y = Capex, group = State, colour = State)) +
geom_line() +
scale_colour_discrete(guide = 'none') +
scale_x_discrete(expand=c(0, 1)) +
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate), method = list(dl.trans(x = x + 2), cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate), method = list(dl.trans(x = x + 2), cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + 2), cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + .5), cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + 1), cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + 1), cex = 0.8)) +
# geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + 1), cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
temp.dat <- structure(list(Year = c("2003", "2004", "2005", "2006", "2007",
"2008", "2009", "2010", "2011", "2012", "2013", "2014", "2003",
"2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011",
"2012", "2013", "2014", "2003", "2004", "2005", "2006", "2007",
"2008", "2009", "2010", "2011", "2012", "2013", "2014", "2003",
"2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011",
"2012", "2013", "2014"), State = structure(c(1L, 1L, 1L, 1L,
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
2L, 2L, 2L, 2L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L, 3L,
4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L, 4L), .Label = c("VIC",
"NSW", "QLD", "WA"), class = "factor"), Capex = c(5.35641472365348,
5.76523240652641, 5.24727577535625, 5.57988239709746, 5.14246402568366,
4.96786288162828, 5.493190785287, 6.08500616799372, 6.5092228474591,
7.03813541623157, 8.34736513875897, 9.04992300432169, 7.15830329914056,
7.21247045701994, 7.81373928617117, 7.76610217197542, 7.9744994967006,
7.93734452080786, 8.29289899132255, 7.85222269563982, 8.12683746325074,
8.61903784301649, 9.7904327253813, 9.75021175267288, 8.2950673974226,
6.6272705639724, 6.50170524635367, 6.15609626379471, 6.43799637295979,
6.9869551384028, 8.36305663640294, 8.31382617231745, 8.65409824343971,
9.70529678167458, 11.3102788081848, 11.8696420977237, 6.77937303542605,
5.51242844820827, 5.35789621712839, 4.38699327451101, 4.4925792218211,
4.29934654081527, 4.54639175257732, 4.70040615159951, 5.04056109514957,
5.49921208937735, 5.96590909090909, 6.18700407463007)), class = "data.frame", row.names = c(NA,
-48L), .Names = c("Year", "State", "Capex"))
ggplot(temp.dat, aes(x = Year, y = Capex, group = State, colour = State)) +
geom_line() +
scale_colour_discrete(guide = 'none') +
scale_x_discrete(expand=c(0, 1)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x + 0.2), "last.points", cex = 0.8)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x - 0.2), "first.points", cex = 0.8))
ggplot(temp.dat, aes(x = Year, y = Capex, group = State, colour = State)) +
geom_line() +
scale_colour_discrete(guide = 'none') +
# scale_x_discrete(expand=c(0, 1)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x + 0.2), "last.points", cex = 0.8)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x - 0.2), "first.points", cex = 0.8))
ggplot(temp.dat, aes(x = Year, y = Capex, group = State, colour = State)) +
geom_line() +
# scale_colour_discrete(guide = 'none') +
scale_x_discrete(expand=c(0, 1)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x + 0.2), "last.points", cex = 0.8)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x - 0.2), "first.points", cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + 1), "last.points", cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + .7), "last.points", cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
geom_dl(aes(label = Isolate, col = Isolate), method = list(dl.trans(x = x + .7, "last.points", cex = 0.8)) +
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate),
method = list("last.points", cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
f
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_dl(aes(label = Isolate, col = Isolate),
method = list("last.points", cex = 0.8)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
geom_dl(aes(label = Isolate, col = Isolate),
method = list("last.points", cex = 0.8)) +
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
geom_dl(aes(label = Isolate, col = Isolate),
method = list("last.points")) +
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
ggplot(temp.dat, aes(x = Year, y = Capex, group = State, colour = State)) +
geom_line() +
scale_colour_discrete(guide = 'none') +
scale_x_discrete(expand=c(0, 1)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x + 0.2), "last.points", cex = 0.8)) +
geom_dl(aes(label = State), method = list(dl.trans(x = x - 0.2), "first.points", cex = 0.8))
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
geom_dl(aes(label = EH_ID, col = Isolate),
method = list("last.points")) +
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
library(dplyr)
lab <- tapply(temp.dat$Capex, temp.dat$State, last)
ggplot(temp.dat) +
geom_line(aes(x = Year, y = Capex, group = State, colour = State)) +
scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names(lab), x = 12, colour = names(lab), y = c(lab), hjust = -.02))
lab
ggplot(temp.dat) +
geom_line(aes(x = Year, y = Capex, group = State, colour = State)) #+
ggplot(temp.dat) +
geom_line(aes(x = Year, y = Capex, group = State, colour = State)) +
# scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names(lab), x = 12, colour = names(lab), y = c(lab), hjust = -.02))
ggplot(temp.dat) +
geom_line(aes(x = Year, y = Capex, group = State, colour = State)) +
# scale_color_discrete(guide = FALSE) +
geom_text(aes(label = names(lab)))
ggplot(temp.dat) +
geom_line(aes(x = Year, y = Capex, group = State, colour = State)) +
# scale_color_discrete(guide = FALSE) +
geom_text(aes(label = lab))
library(ggplot2)
library(ggrepel)
library(dplyr)
install.packages("ggrepel")
library(ggrepel)
library(dplyr)
temp.dat %>%
mutate(label = if_else(Year == max(Year), as.character(State), NA_character_)) %>%
ggplot(aes(x = Year, y = Capex, group = State, colour = State)) +
geom_line() +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE)
Expe008 %>%
mutate(label = if_else(dpi == max(dpi), as.character(Isolate), NA_character_)) %>%
ggplot(aes(x = dpi, y = relativeWeight, group = Isolate, colour = Isolate)) +
geom_line() +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE)
Expe008 %>%
mutate(label = if_else(dpi == max(dpi), as.character(Isolate), NA_character_)) %>%
ggplot(aes(x = dpi, y = relativeWeight, group = EH_ID, colour = Isolate)) +
geom_line() +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE)
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
geom_dl(aes(label = EH_ID, col = Isolate),
method = list("last.points")) +
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
# Plot follow weight
ggplot(Expe008, aes(x = dpi, y = relativeWeight)) +
geom_line(aes(group = EH_ID, col = Isolate)) +
geom_point(size=4, pch = 21, aes(fill = Isolate))+
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
ggtitle("Weight along experiment per individual")
