temp$dpi <- DPI
Newdata <- rbind(Newdata, temp)
}
# Remove useless objects:
rm(temp, DPI, i)
# Add groups and sex
Newdata$infection_isolate[Newdata$Mouse_ID %in% 1:6] <- "EfLab"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 7:12] <- "E64"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 13:18] <- "E88"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 19:23] <- "E139"
Newdata$Mouse_ID %in% c(15, 16)
Newdata$Mouse_ID !%in% c(15, 16)
!Newdata$Mouse_ID %in% c(15, 16)
Newdata[!Newdata$Mouse_ID %in% c(15, 16),]
Newdata$sex <- "male"
Newdata$sex[Newdata$Mouse_ID %in% c(1,2,10,11,12,16,17,18,21,22,23)] <- "female"
Newdata <- Newdata[!Newdata$Mouse_ID %in% c(15, 16),]
ggplot(Newdata, aes(x = dpi, y = weightloss, color = infection_isolate, group = Mouse_ID )) +
geom_point() +
geom_line() +
theme_bw()
source("../R/summarySE.R")
library(ggplot2)
# import file
mydata <- read.csv(file = "../data_raw/NMRIMarch2018/NMRI_M채use.csv")
# Calculate the weight loss compared to dpi0 automatically
for(i in 0:11){
mydata[[paste0("dpi.",i,".weightloss")]] <-
(1 - (mydata[[paste0("dpi.",i,".weight")]] / mydata$dpi.0.weight)) * 100
}
# Change to long format
Newdata <- data.frame(NULL)
for (DPI in 0:11){
temp <- cbind(Mouse_ID = mydata$mouse.ID,
mydata[, grep(paste0("dpi.", paste(DPI, "", sep="\\.")), colnames(mydata))])
names(temp) <- gsub(paste0("dpi.", paste(DPI, "", sep="\\.")),
replacement = "",
x = names(temp))
temp$dpi <- DPI
Newdata <- rbind(Newdata, temp)
}
# Remove useless objects:
rm(temp, DPI, i)
# Add groups and sex
Newdata$infection_isolate[Newdata$Mouse_ID %in% 1:6] <- "EfLab"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 7:12] <- "E64"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 13:18] <- "E88"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 19:23] <- "E139"
# And sex
Newdata$sex <- "male"
Newdata$sex[Newdata$Mouse_ID %in% c(1,2,10,11,12,16,17,18,21,22,23)] <- "female"
# Remove uninfected mice (15 & 16)
Newdata <- Newdata[!Newdata$Mouse_ID %in% c(15, 16),]
# Plot all mice
ggplot(Newdata, aes(x = dpi, y = weightloss, color = infection_isolate, group = Mouse_ID )) +
geom_point() +
geom_line() +
theme_bw()
mydata <- read.csv(file = "../data_raw/NMRIMarch2018/NMRI_M채use.csv")
for(i in 0:11){
mydata[[paste0("dpi.",i,".weightRelativeToInfection(%)")]] <-
(mydata[[paste0("dpi.",i,".weight")]] / mydata$dpi.0.weight) * 100
}
Newdata <- data.frame(NULL)
for (DPI in 0:11){
temp <- cbind(Mouse_ID = mydata$mouse.ID,
mydata[, grep(paste0("dpi.", paste(DPI, "", sep="\\.")), colnames(mydata))])
names(temp) <- gsub(paste0("dpi.", paste(DPI, "", sep="\\.")),
replacement = "",
x = names(temp))
temp$dpi <- DPI
Newdata <- rbind(Newdata, temp)
}
rm(temp, DPI, i)
Newdata$infection_isolate[Newdata$Mouse_ID %in% 1:6] <- "EfLab"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 7:12] <- "E64"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 13:18] <- "E88"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 19:23] <- "E139"
Newdata$sex <- "male"
Newdata$sex[Newdata$Mouse_ID %in% c(1,2,10,11,12,16,17,18,21,22,23)] <- "female"
Newdata <- Newdata[!Newdata$Mouse_ID %in% c(15, 16),]
View(Newdata)
names(Newdata)
ggplot(Newdata, aes(x = dpi, y = "weightRelativeToInfection(%)", color = infection_isolate, group = Mouse_ID )) +
geom_point() +
geom_line() +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point() +
geom_line() +
theme_bw()
source("../R/summarySE.R")
library(ggplot2)
# import file
mydata <- read.csv(file = "../data_raw/NMRIMarch2018/NMRI_M채use.csv")
# Calculate the weight loss compared to dpi0 automatically
for(i in 0:11){
mydata[[paste0("dpi.",i,".weightRelativeToInfection(%)")]] <-
(mydata[[paste0("dpi.",i,".weight")]] / mydata$dpi.0.weight) * 100
}
# Change to long format
Newdata <- data.frame(NULL)
for (DPI in 0:11){
temp <- cbind(Mouse_ID = mydata$mouse.ID,
mydata[, grep(paste0("dpi.", paste(DPI, "", sep="\\.")), colnames(mydata))])
names(temp) <- gsub(paste0("dpi.", paste(DPI, "", sep="\\.")),
replacement = "",
x = names(temp))
temp$dpi <- DPI
Newdata <- rbind(Newdata, temp)
}
# Remove useless objects:
rm(temp, DPI, i)
# Add groups and sex
Newdata$infection_isolate[Newdata$Mouse_ID %in% 1:6] <- "EfLab"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 7:12] <- "E64"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 13:18] <- "E88"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 19:23] <- "E139"
# And sex
Newdata$sex <- "male"
Newdata$sex[Newdata$Mouse_ID %in% c(1,2,10,11,12,16,17,18,21,22,23)] <- "female"
# Plot all mice
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point() +
geom_line() +
theme_bw()
summary_data <- summarySE(Newdata, measurevar="weightRelativeToInfection(%)", groupvars=c("infection_isolate","dpi"))
summary_data
ggplot(summary_data, aes(x = dpi, y = weightloss, colour = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = weightloss-ci, ymax = weightloss+ci), width=1, position = position_dodge(0.2), size = 2) +
geom_line(position = position_dodge(0.2)) +
geom_point(position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=1, position = position_dodge(0.2), size = 2) +
geom_line(position = position_dodge(0.2)) +
geom_point(position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=1, position = position_dodge(0.2), size = 1) +
geom_line(position = position_dodge(0.2)) +
geom_point(position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1) +
geom_line(position = position_dodge(0.2)) +
geom_point(position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1, alpha = .5) +
geom_line(position = position_dodge(0.2)) +
geom_point(position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
Newdata$Neubauer1 <- NA
Newdata$Neubauer2 <- NA
Newdata$Neubauer3 <- NA
Newdata$Neubauer4 <- NA
Newdata$mean <- NA
Newdata$dilution_ml <- NA
Newdata$oocysts_number <- NA
Newdata$OPG <- NA
write.csv(x = Newdata, file = "../data_raw/NMRIMarch2018/followUp.csv", row.names = F)
source("../R/summarySE.R")
library(ggplot2)
mydata <- read.csv(file = "../data_raw/NMRIMarch2018/NMRI_M채use.csv")
for(i in 0:11){
mydata[[paste0("dpi.",i,".weightRelativeToInfection(%)")]] <-
(mydata[[paste0("dpi.",i,".weight")]] / mydata$dpi.0.weight) * 100
}
Newdata <- data.frame(NULL)
for (DPI in 0:11){
temp <- cbind(Mouse_ID = mydata$mouse.ID,
mydata[, grep(paste0("dpi.", paste(DPI, "", sep="\\.")), colnames(mydata))])
names(temp) <- gsub(paste0("dpi.", paste(DPI, "", sep="\\.")),
replacement = "",
x = names(temp))
temp$dpi <- DPI
Newdata <- rbind(Newdata, temp)
}
rm(temp, DPI, i)
Newdata$infection_isolate[Newdata$Mouse_ID %in% 1:6] <- "EfLab"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 7:12] <- "E64"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 13:18] <- "E88"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 19:23] <- "E139"
Newdata$sex <- "male"
Newdata$sex[Newdata$Mouse_ID %in% c(1,2,10,11,12,16,17,18,21,22,23)] <- "female"
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point() +
geom_line() +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point() +
geom_line(alpha = .5) +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point(pch = 21) +
geom_line(alpha = .5) +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point(pch = 21, size = 3) +
geom_line(alpha = .5) +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point(pch = 21, size = 3) +
geom_line(type = "b", alpha = .5) +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_point(pch = 21, size = 3, fill = "white") +
geom_line(type = "b", alpha = .5) +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_line((type = "b", )alpha = .5) +
geom_point(pch = 21, size = 3, fill = "white") +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_line(alpha = .5) +
geom_point(pch = 21, size = 3, fill = "white") +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_line(alpha = .5) +
geom_point(pch = 21, size = 4, fill = "white") +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, group = Mouse_ID )) +
geom_line() +
geom_point(pch = 21, size = 4, fill = "white") +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, fill = infection_isolate, group = Mouse_ID )) +
geom_line() +
geom_point(pch = 21, size = 4, fill = "white") +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, fill = infection_isolate, group = Mouse_ID )) +
geom_line() +
geom_point(pch = 21, size = 4, col = "white") +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, fill = infection_isolate, group = Mouse_ID )) +
geom_line() +
geom_point(pch = 21, size = 4, col = "black") +
theme_bw()
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`, color = infection_isolate, fill = infection_isolate, group = Mouse_ID )) +
geom_line() +
geom_point(pch = 21, size = 4, col = "white") +
theme_bw()
summary_data <- summarySE(Newdata, measurevar="weightRelativeToInfection(%)", groupvars=c("infection_isolate","dpi"))
summary_data
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1, alpha = .5) +
geom_line(position = position_dodge(0.2)) +
geom_point(position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, fill = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1, alpha = .5) +
geom_line(position = position_dodge(0.2)) +
geom_point(pch = 21, position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, fill = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1, alpha = .5) +
geom_line(position = position_dodge(0.2)) +
geom_point(pch = 21, position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_fill_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, fill = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1, alpha = .5) +
geom_line(position = position_dodge(0.2), size = 2) +
geom_point(pch = 21, position = position_dodge(0.2), size=3) +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_fill_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, fill = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1, alpha = .5) +
geom_line(position = position_dodge(0.2), size = 2) +
geom_point(pch = 21, position = position_dodge(0.2), size=3, col = "white") +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_fill_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
Newdata$Neubauer1 <- NA
Newdata$Neubauer2 <- NA
Newdata$Neubauer3 <- NA
Newdata$Neubauer4 <- NA
Newdata$mean <- NA
Newdata$dilution_ml <- NA
Newdata$oocysts_number <- NA
Newdata$OPG <- NA
write.csv(x = Newdata, file = "../data_raw/NMRIMarch2018/followUp.csv", row.names = F)
source("../R/summarySE.R")
library(ggplot2)
mydata <- read.csv(file = "../data_raw/NMRIMarch2018/NMRI_M채use.csv")
for(i in 0:11){
mydata[[paste0("dpi.",i,".weightRelativeToInfection(%)")]] <-
(mydata[[paste0("dpi.",i,".weight")]] / mydata$dpi.0.weight) * 100
}
Newdata <- data.frame(NULL)
for (DPI in 0:11){
temp <- cbind(Mouse_ID = mydata$mouse.ID,
mydata[, grep(paste0("dpi.", paste(DPI, "", sep="\\.")), colnames(mydata))])
names(temp) <- gsub(paste0("dpi.", paste(DPI, "", sep="\\.")),
replacement = "",
x = names(temp))
temp$dpi <- DPI
Newdata <- rbind(Newdata, temp)
}
rm(temp, DPI, i)
Newdata$infection_isolate[Newdata$Mouse_ID %in% 1:6] <- "EfLab"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 7:12] <- "E64"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 13:18] <- "E88"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 19:23] <- "E139"
Newdata$sex <- "male"
Newdata$sex[Newdata$Mouse_ID %in% c(1,2,10,11,12,16,17,18,21,22,23)] <- "female"
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`,
color = infection_isolate, fill = infection_isolate, group = Mouse_ID )) +
geom_line() +
geom_point(pch = 21, size = 4, col = "white") +
theme_bw()
summary_data <- summarySE(Newdata, measurevar="weightRelativeToInfection(%)", groupvars=c("infection_isolate","dpi"))
summary_data
ggplot(summary_data, aes(x = dpi, y = `weightRelativeToInfection(%)`,
colour = infection_isolate, fill = infection_isolate, group = infection_isolate)) +
geom_errorbar(aes(ymin = `weightRelativeToInfection(%)`-ci,
ymax = `weightRelativeToInfection(%)`+ci),
width=0, position = position_dodge(0.2), size = 1, alpha = .5) +
geom_line(position = position_dodge(0.2), size = 2) +
geom_point(pch = 21, position = position_dodge(0.2), size=3, col = "white") +
theme_bw() +
theme(legend.position=c(.9, .2), legend.title = element_text(size=20, face="bold"),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold")) +
scale_color_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_fill_manual(values=c("#336600", "#66CC00", "#FF3300", "#660000"),
name="Infection\nstrains")+
scale_x_continuous(breaks = 0:11, name = "Day post infection" )+
scale_y_continuous(name = "Weight loss relative to infection day")
Newdata
source("MLE_hybrid_functions.R")
source("Models/MacroParasiteLoad-NegBin.R")
source("../R/summarySE.R")
library(ggplot2)
mydata <- read.csv(file = "../data_raw/NMRIMarch2018/NMRI_M채use.csv")
for(i in 0:11){
mydata[[paste0("dpi.",i,".weightRelativeToInfection(%)")]] <-
(mydata[[paste0("dpi.",i,".weight")]] / mydata$dpi.0.weight) * 100
}
Newdata <- data.frame(NULL)
for (DPI in 0:11){
temp <- cbind(Mouse_ID = mydata$mouse.ID,
mydata[, grep(paste0("dpi.", paste(DPI, "", sep="\\.")), colnames(mydata))])
names(temp) <- gsub(paste0("dpi.", paste(DPI, "", sep="\\.")),
replacement = "",
x = names(temp))
temp$dpi <- DPI
Newdata <- rbind(Newdata, temp)
}
rm(temp, DPI, i)
Newdata$infection_isolate[Newdata$Mouse_ID %in% 1:6] <- "EfLab"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 7:12] <- "E64"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 13:18] <- "E88"
Newdata$infection_isolate[Newdata$Mouse_ID %in% 19:23] <- "E139"
Newdata$sex <- "male"
Newdata$sex[Newdata$Mouse_ID %in% c(1,2,10,11,12,16,17,18,21,22,23)] <- "female"
ggplot(Newdata, aes(x = dpi, y = `weightRelativeToInfection(%)`,
color = infection_isolate, fill = infection_isolate, group = Mouse_ID )) +
geom_line() +
geom_point(pch = 21, size = 4, col = "white") +
theme_bw()
write.csv(Newdata, file = "../data_clean/NMRI_blabla.csv", row.names = F)
myDFName = "../data_clean/template.csv"
myDF <- data.frame(matrix(ncol = 18, nrow = 0))
x <- c("original_mouse_id", "original_mouse_id_mother",
"original_mouse_id_father", "sex", "born", "isolation",
"age_at_infection", "Mouse_strain", "comment",
"num.inf", "Infection_date", "weight", "rel.weight", "label",
"feces_weight", "dilution_before_counting",
"oocysts.per.g", "oocysts.per.tube")
colnames(myDF) <- x
write.csv(myDF, myDFName, row.names = F)
makeGeneralInfoTable <- function(myDFName){
# Part 1. Make data frame
myDF <- data.frame(matrix(ncol = 18, nrow = 0))
x <- c("original_mouse_id", "original_mouse_id_mother",
"original_mouse_id_father", "sex", "born", "isolation",
"age_at_infection", "Mouse_strain", "comment",
"num.inf", "Infection_date", "weight", "rel.weight", "label",
"feces_weight", "dilution_before_counting",
"oocysts.per.g", "oocysts.per.tube")
colnames(myDF) <- x
write.csv(myDF, myDFName, row.names = F)
}
myDF <- read.csv("template.csv")
myDF <- read.csv("../data_clean/template.csv")
makeInfectionExperimentTable <- function(myDFName){
# Give EH_ids
num = as.numeric(sub("LM", "", firstEH_Id))
num = num + (1:(Nmice))
EH_id = paste0("LM", sprintf("%04d", num))
EH_id = rep(EH_id, lengthExpe+1)
# Add DPI
dpi = rep(0:lengthExpe, Nmice)
dpi = dpi[order(dpi)]
# Bind all columns in a DF
myDF <- cbind(read.csv("../data_clean/template.csv"),
EH_id, dpi)
# Spread infection equally among sex and Mouse_strain
}
makeInfectionExperimentTable(myDFName)
