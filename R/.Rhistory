summary(lmer(relativeWeight ~ Mouse_strain + dpi + 1|EH_ID, data = ExpeDF_003_4Symptomatic))
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG + 1, y = relativeWeight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
facet_grid(.~dpi) +
# coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG + 1, y = relativeWeight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
facet_grid(Mouse_strain~dpi) +
# coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG + 1, y = relativeWeight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
# coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight relative to infection (%)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
# coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
# coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
# coord_cartesian(ylim =  c(80,110)) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
theme(legend.position = "none") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
theme(element_text(legend.position = "none")) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
theme(element_text(legend.position = "none")) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
theme(legend.position="none") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~.) +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain, fill = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~., scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~., scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(EH_ID~., scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(~EH_ID, scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(.~EH_ID, scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(EH_ID~., scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(EH_ID~Exp_ID, scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4Symptomatic,
aes(x = OPG > 0, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~., scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4,
aes(x = OPG > 0, y = weight, group = Mouse_strain)) +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
scale_y_continuous(name = "Weight (g)") +
scale_x_log10() +
facet_grid(Mouse_strain~., scales = "free") +
ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4,
aes(x = OPG > 0, y = weight, group = Mouse_strain)) +
geom_violin()
ggplot(ExpeDF_003_4,
aes(x = OPG > 0, y = weight)) +
geom_violin()
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
geom_violin()
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
geom_boxplot()
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
geom_boxplot(aes(group = Mouse_strain))
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
geom_boxplot() +
# geom_point(aes(fill = EH_ID), pch = 21, size=3)  +,
# geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
# scale_y_continuous(name = "Weight (g)") +
# scale_x_log10() +
facet_grid(Mouse_strain~., scales = "free") +
# ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
geom_boxplot() +
# geom_point(aes(fill = EH_ID), pch = 21, size=3)  +,
# geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
# scale_y_continuous(name = "Weight (g)") +
# scale_x_log10() +
facet_grid(. ~ Mouse_strain, scales = "free") +
# ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
geom_boxplot() +
# geom_point(aes(fill = EH_ID), pch = 21, size=3)  +,
# geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
# scale_y_continuous(name = "Weight (g)") +
# scale_x_log10() +
facet_grid(. ~ EH_ID, scales = "free") +
# ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
# geom_boxplot() +
# geom_point(aes(fill = EH_ID), pch = 21, size=3)  +,
# geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
# scale_y_continuous(name = "Weight (g)") +
# scale_x_log10() +
facet_grid(EH_ID ~ ., scales = "free") +
# ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
# geom_boxplot() +
# geom_point(aes(fill = EH_ID), pch = 21, size=3)  +,
# geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
# scale_y_continuous(name = "Weight (g)") +
# scale_x_log10() +
facet_grid(EH_ID ~ Mouse_strain, scales = "free") +
# ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
# geom_boxplot() +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +,
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
# geom_boxplot() +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
# geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
# scale_y_continuous(name = "Weight (g)") +
# scale_x_log10() +
facet_grid(EH_ID ~ Mouse_strain, scales = "free") +
# ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
ggplot(ExpeDF_003_4[!is.na(ExpeDF_003_4$OPG), ],
aes(x = OPG > 0, y = weight)) +
geom_boxplot() +
geom_point(aes(fill = EH_ID), pch = 21, size=3)  +
# geom_smooth(aes(fill = Mouse_strain), method = "lm", col = "grey") +
# scale_y_continuous(name = "Weight (g)") +
# scale_x_log10() +
facet_grid(EH_ID ~ Mouse_strain, scales = "free") +
# ggtitle("Relative weight loss compared to dpi3, during the symptomatic phase, vs parasite outcome (OPG)") +
mytheme +
theme(legend.position="none")
install.packages("dplyr")
install.packages("tidyr")
install.packages("gridExtra")
install.packages("lme4")
install.packages("lmertest")
install.packages("lmerTest")
source("../R/functions.R")
library(ggplot2)
library(gridExtra)
library(reshape2)
library(scales)
library(lme4)
library(lmerTest)
mytheme <- theme_bw()+
theme(plot.title = element_text(size=22), plot.subtitle = element_text(size = 20),
legend.text = element_text(size = 20),
axis.text=element_text(size=20),
axis.title=element_text(size=20,face="bold"),
legend.key = element_rect(size = 5),
legend.key.size = unit(1.5, 'lines'),
strip.text = element_text(size=25))
calculateWeightLoss <- function(x, startingDay = 0){
# define weight at infection
A = x[x$dpi == startingDay, c("weight", "EH_ID")]
names(A)[1] = "startingWeight"
x = merge(x, A)
# Cumulative sum of our weight loss
x = x %>%
group_by(EH_ID) %>%
dplyr::arrange(dpi, .by_group = TRUE) %>%
dplyr::mutate(relativeWeight = weight / startingWeight * 100)
x = data.frame(x)
return(x)
}
calculateOPG <- function(ExpeDF){
ExpeDF$mean_Neubauer <-
(ExpeDF$Neubauer1 + ExpeDF$Neubauer2 + ExpeDF$Neubauer3 + ExpeDF$Neubauer4) / 4
ExpeDF$OPG <- ExpeDF$mean_Neubauer * 10000 / ExpeDF$dilution_ml / ExpeDF$fecweight
return(ExpeDF)
}
########################### Exp005 : Full expe including hybrids, July 2018
oo <- read.csv("../data/3_recordingTables/Exp005_full_RECORDoocysts.csv", na.strings = c("NA", " ", "n.a."))
View(oo)
we <- read.csv("../data/3_recordingTables/Exp005_full_RECORDweight.csv", na.strings = c("NA", " "))
design <- rbind(read.csv("../data/2_designTables/Inf1a_Exp005.DESIGN.csv", na.strings = c("NA", " ")),
read.csv("../data/2_designTables/Inf2a_Exp005.DESIGN.csv", na.strings = c("NA", " ")),
read.csv("../data/2_designTables/Inf1b_Exp005.DESIGN.csv", na.strings = c("NA", " ")),
read.csv("../data/2_designTables/Inf2b_Exp005.DESIGN.csv", na.strings = c("NA", " ")))
# Correct error
names(design)[names(design) == "EH_id"] <- "EH_ID"
# Correct space error
design$EH_ID <- gsub(" ", "", design$EH_ID)
design$HybridStatus <- gsub(" ", "", design$HybridStatus)
ExpeDF_005 <- merge(oo, we, by = c("labels", "Expe"))
ExpeDF_005 <- merge(ExpeDF_005, design, by = "EH_ID", all.x = T)
## Correct error space
ExpeDF_005$Strain <- gsub(" ", "", ExpeDF_005$Strain)
# Correct error non numeric
ExpeDF_005$weight <- as.numeric(as.character(ExpeDF_005$weight))
ExpeDF_005$weight_dpi0 <- as.numeric(as.character(ExpeDF_005$weight_dpi0))
# Correct weight loss
ExpeDF_005$weightloss <- ExpeDF_005$weight_dpi0 - ExpeDF_005$weight
# Add mice subspecies info
ExpeDF_005$Mouse_subspecies <- factor(as.factor(ExpeDF_005$Strain),
levels = c("BUSNA_BUSNA","BUSNA_PWD","BUSNA_STRA","PWD_BUSNA",
"PWD_PWD","PWD_SCHUNT","SCHUNT_PWD","SCHUNT_SCHUNT",
"SCHUNT_STRA","STRA_BUSNA","STRA_SCHUNT","STRA_STRA"),
labels = c("M.m.musculus P", "M.m.musculus F1",
"Hybrid", "M.m.musculus F1",
"M.m.musculus P","Hybrid",
"Hybrid", "M.m.domesticus P",
"M.m.domesticus F1","Hybrid",
"M.m.domesticus F1","M.m.domesticus P"))
# # Mouse_strain: West should always be left
ExpeDF_005$Mouse_strain <- factor(as.factor(ExpeDF_005$Strain),
levels = c("BUSNA_BUSNA","BUSNA_PWD",
"BUSNA_STRA","PWD_BUSNA",
"PWD_PWD","PWD_SCHUNT",
"SCHUNT_PWD","SCHUNT_SCHUNT",
"SCHUNT_STRA","STRA_BUSNA",
"STRA_SCHUNT","STRA_STRA"),
labels = c("M.m.musculus P \n(BUSNA_BUSNA)", "M.m.musculus F1 \n(BUSNA_PWD)",
"Hybrid \n(BUSNA_STRA)", "M.m.musculus F1 \n(PWD_BUSNA)",
"M.m.musculus P \n(PWD_PWD)","Hybrid \n(PWD_SCHUNT)",
"Hybrid \n(SCHUNT_PWD)", "M.m.domesticus P \n(SCHUNT_SCHUNT)",
"M.m.domesticus F1 \n(SCHUNT_STRA)","Hybrid \n(STRA_BUSNA)",
"M.m.domesticus F1 \n(STRA_SCHUNT)","M.m.domesticus P \n(STRA_STRA)"))
# Correct hybrid status
ExpeDF_005$HybridStatus <- factor(ExpeDF_005$HybridStatus,
levels = c("intersubsp.hybrids", "outbredhybrids", "parentalstrains"),
labels = c("hybrids", "outbred", "parents"))
# Add infection isolate
ExpeDF_005$infection_isolate <- ExpeDF_005$Eimeria
# Enter Eimeria species
ExpeDF_005$Eimeria_species[ExpeDF_005$infection_isolate %in% c("E88", "Eflab", "EfLab")] <- "E.falciformis"
ExpeDF_005$Eimeria_species[ExpeDF_005$infection_isolate %in% c("E64", "EI64", "E139")] = "E.ferrisi"
# calculate OPG
# rename
names(ExpeDF_005) <- gsub("oocyst_sq", "Neubauer", names(ExpeDF_005))
names(ExpeDF_005) <- gsub("dilution", "dilution_ml", names(ExpeDF_005))
ExpeDF_005$dilution_ml <- as.numeric(as.character(ExpeDF_005$dilution_ml))
ExpeDF_005$fecweight <- as.numeric(as.character(ExpeDF_005$fecweight))
# Replace NA by 0
ExpeDF_005$fecweight[is.na(ExpeDF_005$fecweight)] <- 0
ExpeDF_005 <- calculateOPG(ExpeDF = ExpeDF_005)
View(ExpeDF_005)
# Add OPG status
ExpeDF_005$OPGstatus[is.na(ExpeDF_005$OPG)] = "na"
ExpeDF_005$OPGstatus[!is.na(ExpeDF_005$OPG) & ExpeDF_005$OPG > 0] = "positive"
ExpeDF_005$OPGstatus[!is.na(ExpeDF_005$OPG) & ExpeDF_005$OPG == 0] = "negative"
ExpeDF_005$OPGstatus = as.factor(ExpeDF_005$OPGstatus)
# Split in 2 infection batches (Efalciformis and Eferrisi are studied separetely)
ExpeDF_005_E88 <- ExpeDF_005[ExpeDF_005$infection_isolate %in% "E88",]
ExpeDF_005_E64 <- ExpeDF_005[ExpeDF_005$infection_isolate %in% "E64",]
# calculate relative weight loss compared to dpi3 for E64
ExpeDF_005_E64 <- calculateWeightLoss(ExpeDF_005_E64, startingDay = 3)
ExpeDF_005_E64$relativeWeight <- as.numeric(as.character(ExpeDF_005_E64$relativeWeight))
# calculate relative weight loss compared to dpi7 for E88
ExpeDF_005_E88 <- calculateWeightLoss(ExpeDF_005_E88, startingDay = 7)
ExpeDF_005_E88$relativeWeight <- as.numeric(as.character(ExpeDF_005_E88$relativeWeight))
# calculate summary statistics on weight loss
summaryWeight_005_E64 <- summarySE(ExpeDF_005_E64, measurevar = "relativeWeight",
groupvars=c("HybridStatus", "dpi", "Expe"), na.rm = T)
summaryWeight_005_E64$ci[is.na(summaryWeight_005_E64$ci)] <- 0
summaryWeight_005_E88 <- summarySE(ExpeDF_005_E88, measurevar = "relativeWeight",
groupvars=c("HybridStatus", "dpi", "Expe"), na.rm = T)
summaryWeight_005_E88$ci[is.na(summaryWeight_005_E88$ci)] <- 0
# calculate summary statistics on oocysts shedding
summaryOocysts_005_E64 <-summarySE(ExpeDF_005_E64, measurevar="OPG",
groupvars=c("HybridStatus", "dpi", "Expe"), na.rm = T)
summaryOocysts_005_E64$ci[is.na(summaryOocysts_005_E64$ci)] <- 0
summaryOocysts_005_E88 <-summarySE(ExpeDF_005_E88, measurevar="OPG",
groupvars=c("HybridStatus", "dpi", "Expe"), na.rm = T)
summaryOocysts_005_E88$ci[is.na(summaryOocysts_005_E88$ci)] <- 0
```{r weightalong5_E64, echo=FALSE, warning=FALSE, fig.width = 12, fig.height = 10}
ggplot(ExpeDF_005_E64, aes(x = dpi, y = weight, fill = OPGstatus)) +
geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5) +
geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5) +
# scale_color_manual(values = c("blue", "purple", "red")) +
geom_point(size=4, pch = 21, color = "black")+
scale_fill_manual(values = c("lightgrey", "black", "yellow")) +
mytheme +
facet_grid(HybridStatus ~ Expe) +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight (g)") +
theme(strip.text.y = element_text(size = 15)) +
# theme(legend.position="none") +
ggtitle("Weight along experiment per individual (E64)", subtitle = "yellow : oocysts detected in feces")
ggplot(ExpeDF_005_E64, aes(x = dpi, y = relativeWeight, fill = OPGstatus)) +
geom_rect(aes(xmin = 3, xmax = 8, ymin = 80, ymax = 110), fill = "lightgrey", alpha = .5) +
geom_line(aes(group = EH_ID, col = Mouse_strain), size = 2, alpha = 0.5) +
# scale_color_manual(values = c("blue", "purple", "red")) +
geom_point(size=4, pch = 21, color = "black")+
scale_fill_manual(values = c("lightgrey", "black", "yellow")) +
mytheme +
facet_grid(HybridStatus ~ Expe) +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight relative to dpi3 (%)") +
theme(strip.text.y = element_text(size = 15)) +
theme(legend.position="bottom") +
ggtitle("Relative weight along experiment compared to dpi3 (E64)", subtitle = "yellow : oocysts detected in feces")
ggplot(summaryWeight_005_E64, aes(x = dpi, y = relativeWeight))+
geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .7) +
geom_errorbar(aes(ymin = relativeWeight - ci, ymax = relativeWeight + ci, col = HybridStatus)) +
geom_line(aes(group = HybridStatus, col = HybridStatus), size = 2, alpha = 0.5) +
geom_point(aes(fill = HybridStatus), size=4, pch = 21, color = "black") +
scale_color_manual(values = c("blue", "purple", "red")) +
scale_fill_manual(values = c("blue", "purple", "red")) +
mytheme +
facet_grid(.~Expe) +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
scale_y_continuous(name = "Weight relative to dpi3 (%)") +
# coord_cartesian(ylim = c(85, 115)) +
# theme(legend.position="none", strip.text = element_text(size = 15)) +
ggtitle("Mean relative weight along experiment compared to dpi3 (E64)")
ExpeDF_005_E64_Symptomatic <- ExpeDF_005_E64[ExpeDF_005_E64$dpi %in% 3:8,]
max.loss_005_E64 <- do.call("rbind", by(ExpeDF_005_E64_Symptomatic, ExpeDF_005_E64_Symptomatic$EH_ID, function (x){
m.loss <- which(x$relativeWeight == min(x$relativeWeight, na.rm=TRUE))
x[m.loss,]
}))
ggplot(max.loss_005_E64, aes(HybridStatus,100-relativeWeight, color=infection_isolate)) +
geom_boxplot(color = "black")+
ggtitle("Maximum weigth loss during the symptomatic phase") +
facet_wrap(~Expe) +
geom_jitter(width=0.1, size=7, pch = 21,
color = "black", aes(fill = HybridStatus), alpha = 0.8) +
labs(y= "Maximum weigth loss relative to weight at dpi 3", x= "Hybrid status")+
# scale_fill_manual(values = c("blue", "purple", "red")) +
mytheme +
theme(legend.position="none")
# non-parametric tests
print("first batch")
maxloss_E64B1 <- max.loss_005_E64[max.loss_005_E64$Expe == "Expe005_1b",]
kruskal.test(relativeWeight ~ HybridStatus, data = maxloss_E64B1)
pairwise.wilcox.test(maxloss_E64B1$relativeWeight, maxloss_E64B1$HybridStatus,
p.adjust.method = "BH")
print("second batch")
maxloss_E64B2 <- max.loss_005_E64[max.loss_005_E64$Expe == "Expe005_2b",]
kruskal.test(relativeWeight ~ HybridStatus, data = maxloss_E64B2)
pairwise.wilcox.test(maxloss_E64B2$relativeWeight, maxloss_E64B2$HybridStatus,
p.adjust.method = "BH")
# library(nlme)
# lme(fixed = max.loss_005_E64$HybridStatus, data = max.loss_005_E64, random = max.loss_005_E64$Mouse_strain)
```
ggplot(ExpeDF_005_E64, aes(x = dpi, y = OPG, fill = infection_isolate))+
geom_rect(aes(xmin = 3, xmax = 8, ymin = -Inf, ymax = Inf), fill = "lightgrey", alpha = .5) +
geom_line(aes(group = EH_ID, col = Mouse_strain), alpha = 0.5, size = 2) +
geom_point(size=3, aes(color = Mouse_strain))+
# scale_color_manual(values = c("blue", "purple", "red")) +
facet_grid(HybridStatus ~ Expe) +
mytheme +
scale_x_continuous(breaks = 0:11, name = "Day post infection (dpi)") +
ylab("Oocysts shedding along infection (OPG)") +
ggtitle("Oocyst shedding along experiment (E64)") +
theme(legend.position="none")
